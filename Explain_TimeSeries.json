{
  "explainVersion": "1",
  "stages": [
    {
      "$cursor": {
        "queryPlanner": {
          "namespace": "geofence.system.buckets.containers",
          "parsedQuery": {
            "$_internalBucketGeoWithin": {
              "withinRegion": {
                "$geometry": {
                  "type": "Polygon",
                  "coordinates": [
                    [
                      [
                        121.4737,
                        31.23437845899353
                      ],
                      [
                        121.47548050452737,
                        31.234075616835057
                      ],
                      [
                        121.47698994338076,
                        31.233213195332997
                      ],
                      [
                        121.47799851817783,
                        31.231922490343166
                      ],
                      [
                        121.4783526825485, 31.2304
                      ],
                      [
                        121.47799851817783,
                        31.228877509656833
                      ],
                      [
                        121.47698994338076,
                        31.227586804667002
                      ],
                      [
                        121.47548050452737,
                        31.226724383164942
                      ],
                      [
                        121.4737,
                        31.22642154100647
                      ],
                      [
                        121.47191949547262,
                        31.226724383164942
                      ],
                      [
                        121.47041005661923,
                        31.227586804667002
                      ],
                      [
                        121.46940148182216,
                        31.228877509656833
                      ],
                      [
                        121.46904731745148,
                        31.2304
                      ],
                      [
                        121.46940148182216,
                        31.231922490343166
                      ],
                      [
                        121.47041005661923,
                        31.233213195332997
                      ],
                      [
                        121.47191949547262,
                        31.234075616835057
                      ],
                      [
                        121.4737,
                        31.23437845899353
                      ],
                      [
                        121.4737,
                        31.23437845899353
                      ]
                    ]
                  ]
                }
              },
              "field": "location"
            }
          },
          "indexFilterSet": false,
          "queryHash": "F5E64C37",
          "planCacheShapeHash": "F5E64C37",
          "planCacheKey": "296D3DD2",
          "optimizationTimeMillis": 0,
          "maxIndexedOrSolutionsReached": false,
          "maxIndexedAndSolutionsReached": false,
          "maxScansToExplodeReached": false,
          "prunedSimilarIndexes": false,
          "winningPlan": {
            "isCached": false,
            "stage": "FETCH",
            "filter": {
              "$_internalBucketGeoWithin": {
                "withinRegion": {
                  "$geometry": {
                    "type": "Polygon",
                    "coordinates": [
                      [
                        [
                          121.4737,
                          31.23437845899353
                        ],
                        [
                          121.47548050452737,
                          31.234075616835057
                        ],
                        [
                          121.47698994338076,
                          31.233213195332997
                        ],
                        [
                          121.47799851817783,
                          31.231922490343166
                        ],
                        [
                          121.4783526825485,
                          31.2304
                        ],
                        [
                          121.47799851817783,
                          31.228877509656833
                        ],
                        [
                          121.47698994338076,
                          31.227586804667002
                        ],
                        [
                          121.47548050452737,
                          31.226724383164942
                        ],
                        [
                          121.4737,
                          31.22642154100647
                        ],
                        [
                          121.47191949547262,
                          31.226724383164942
                        ],
                        [
                          121.47041005661923,
                          31.227586804667002
                        ],
                        [
                          121.46940148182216,
                          31.228877509656833
                        ],
                        [
                          121.46904731745148,
                          31.2304
                        ],
                        [
                          121.46940148182216,
                          31.231922490343166
                        ],
                        [
                          121.47041005661923,
                          31.233213195332997
                        ],
                        [
                          121.47191949547262,
                          31.234075616835057
                        ],
                        [
                          121.4737,
                          31.23437845899353
                        ],
                        [
                          121.4737,
                          31.23437845899353
                        ]
                      ]
                    ]
                  }
                },
                "field": "location"
              }
            },
            "inputStage": {
              "stage": "IXSCAN",
              "keyPattern": {
                "data.location": "2dsphere_bucket"
              },
              "indexName": "location_2dsphere",
              "isMultiKey": true,
              "isUnique": false,
              "isSparse": false,
              "isPartial": false,
              "indexVersion": 2,
              "direction": "forward",
              "indexBounds": {
                "data.location": [
                  "[3819052484010180608, 3819052484010180608]",
                  "[3868592079911256064, 3868592079911256064]",
                  "[3869225398608855040, 3869225398608855040]",
                  "[3869278175166988288, 3869278175166988288]",
                  "[3869278450044895232, 3869278450044895232]",
                  "[3869278450581766145, 3869278451118637055]",
                  "[3869278451118637056, 3869278451118637056]",
                  "[3869278454339862528, 3869278454339862528]",
                  "[3869278456487346177, 3869278458634829823]",
                  "[3869278458634829825, 3869278460782313471]",
                  "[3869278460782313473, 3869278461319184383]",
                  "[3869278461856055296, 3869278461856055296]",
                  "[3869278462661361664, 3869278462661361664]",
                  "[3869278462661361665, 3869278462795579391]",
                  "[3869278462929797120, 3869278462929797120]",
                  "[3869278467224764416, 3869278467224764416]",
                  "[3869278518764371968, 3869278518764371968]",
                  "[3869278622380457985, 3869278622917328895]",
                  "[3869278622917328896, 3869278622917328896]",
                  "[3869278622917328897, 3869278623454199807]",
                  "[3869278625064812544, 3869278625064812544]",
                  "[3869278625601683457, 3869278625735901183]",
                  "[3869278625870118912, 3869278625870118912]",
                  "[3869278626004336641, 3869278626138554367]",
                  "[3869278626138554368, 3869278626138554368]",
                  "[3869278626138554369, 3869278628286038015]",
                  "[3869278628286038017, 3869278630433521663]",
                  "[3869278630433521665, 3869278639023456255]",
                  "[3869278639023456256, 3869278639023456256]",
                  "[3869278639023456257, 3869278639560327167]",
                  "[3869278640097198080, 3869278640097198080]",
                  "[3869278640634068993, 3869278641170939903]",
                  "[3869278641170939905, 3869278641707810815]",
                  "[3869278642244681728, 3869278642244681728]",
                  "[3869278643318423552, 3869278643318423552]",
                  "[3869278650431963137, 3869278650566180863]",
                  "[3869278650566180864, 3869278650566180864]",
                  "[3869278650608123905, 3869278650616512511]",
                  "[3869278650616512512, 3869278650616512512]",
                  "[3869278650633289728, 3869278650633289728]",
                  "[3869278650834616320, 3869278650834616320]",
                  "[3869278651908358144, 3869278651908358144]",
                  "[3869278656203325440, 3869278656203325440]",
                  "[3869279274678616064, 3869279274678616064]",
                  "[3869282573213499392, 3869282573213499392]",
                  "[3869436504841388032, 3869436504841388032]",
                  "[3869717979818098688, 3869717979818098688]",
                  "[3873095679538626560, 3873095679538626560]"
                ]
              }
            }
          },
          "rejectedPlans": []
        },
        "executionStats": {
          "executionSuccess": true,
          "nReturned": 288027,
          "executionTimeMillis": 227693,
          "totalKeysExamined": 288040,
          "totalDocsExamined": 288027,
          "executionStages": {
            "isCached": false,
            "stage": "FETCH",
            "filter": {
              "$_internalBucketGeoWithin": {
                "withinRegion": {
                  "$geometry": {
                    "type": "Polygon",
                    "coordinates": [
                      [
                        [
                          121.4737,
                          31.23437845899353
                        ],
                        [
                          121.47548050452737,
                          31.234075616835057
                        ],
                        [
                          121.47698994338076,
                          31.233213195332997
                        ],
                        [
                          121.47799851817783,
                          31.231922490343166
                        ],
                        [
                          121.4783526825485,
                          31.2304
                        ],
                        [
                          121.47799851817783,
                          31.228877509656833
                        ],
                        [
                          121.47698994338076,
                          31.227586804667002
                        ],
                        [
                          121.47548050452737,
                          31.226724383164942
                        ],
                        [
                          121.4737,
                          31.22642154100647
                        ],
                        [
                          121.47191949547262,
                          31.226724383164942
                        ],
                        [
                          121.47041005661923,
                          31.227586804667002
                        ],
                        [
                          121.46940148182216,
                          31.228877509656833
                        ],
                        [
                          121.46904731745148,
                          31.2304
                        ],
                        [
                          121.46940148182216,
                          31.231922490343166
                        ],
                        [
                          121.47041005661923,
                          31.233213195332997
                        ],
                        [
                          121.47191949547262,
                          31.234075616835057
                        ],
                        [
                          121.4737,
                          31.23437845899353
                        ],
                        [
                          121.4737,
                          31.23437845899353
                        ]
                      ]
                    ]
                  }
                },
                "field": "location"
              }
            },
            "nReturned": 288027,
            "executionTimeMillisEstimate": 153221,
            "works": 288040,
            "advanced": 288027,
            "needTime": 12,
            "needYield": 0,
            "saveState": 9042,
            "restoreState": 9041,
            "isEOF": 1,
            "docsExamined": 288027,
            "alreadyHasObj": 0,
            "inputStage": {
              "stage": "IXSCAN",
              "nReturned": 288027,
              "executionTimeMillisEstimate": 922,
              "works": 288040,
              "advanced": 288027,
              "needTime": 12,
              "needYield": 0,
              "saveState": 9042,
              "restoreState": 9041,
              "isEOF": 1,
              "keyPattern": {
                "data.location": "2dsphere_bucket"
              },
              "indexName": "location_2dsphere",
              "isMultiKey": true,
              "isUnique": false,
              "isSparse": false,
              "isPartial": false,
              "indexVersion": 2,
              "direction": "forward",
              "indexBounds": {
                "data.location": [
                  "[3819052484010180608, 3819052484010180608]",
                  "[3868592079911256064, 3868592079911256064]",
                  "[3869225398608855040, 3869225398608855040]",
                  "[3869278175166988288, 3869278175166988288]",
                  "[3869278450044895232, 3869278450044895232]",
                  "[3869278450581766145, 3869278451118637055]",
                  "[3869278451118637056, 3869278451118637056]",
                  "[3869278454339862528, 3869278454339862528]",
                  "[3869278456487346177, 3869278458634829823]",
                  "[3869278458634829825, 3869278460782313471]",
                  "[3869278460782313473, 3869278461319184383]",
                  "[3869278461856055296, 3869278461856055296]",
                  "[3869278462661361664, 3869278462661361664]",
                  "[3869278462661361665, 3869278462795579391]",
                  "[3869278462929797120, 3869278462929797120]",
                  "[3869278467224764416, 3869278467224764416]",
                  "[3869278518764371968, 3869278518764371968]",
                  "[3869278622380457985, 3869278622917328895]",
                  "[3869278622917328896, 3869278622917328896]",
                  "[3869278622917328897, 3869278623454199807]",
                  "[3869278625064812544, 3869278625064812544]",
                  "[3869278625601683457, 3869278625735901183]",
                  "[3869278625870118912, 3869278625870118912]",
                  "[3869278626004336641, 3869278626138554367]",
                  "[3869278626138554368, 3869278626138554368]",
                  "[3869278626138554369, 3869278628286038015]",
                  "[3869278628286038017, 3869278630433521663]",
                  "[3869278630433521665, 3869278639023456255]",
                  "[3869278639023456256, 3869278639023456256]",
                  "[3869278639023456257, 3869278639560327167]",
                  "[3869278640097198080, 3869278640097198080]",
                  "[3869278640634068993, 3869278641170939903]",
                  "[3869278641170939905, 3869278641707810815]",
                  "[3869278642244681728, 3869278642244681728]",
                  "[3869278643318423552, 3869278643318423552]",
                  "[3869278650431963137, 3869278650566180863]",
                  "[3869278650566180864, 3869278650566180864]",
                  "[3869278650608123905, 3869278650616512511]",
                  "[3869278650616512512, 3869278650616512512]",
                  "[3869278650633289728, 3869278650633289728]",
                  "[3869278650834616320, 3869278650834616320]",
                  "[3869278651908358144, 3869278651908358144]",
                  "[3869278656203325440, 3869278656203325440]",
                  "[3869279274678616064, 3869279274678616064]",
                  "[3869282573213499392, 3869282573213499392]",
                  "[3869436504841388032, 3869436504841388032]",
                  "[3869717979818098688, 3869717979818098688]",
                  "[3873095679538626560, 3873095679538626560]"
                ]
              },
              "keysExamined": 288040,
              "seeks": 13,
              "dupsTested": 288027,
              "dupsDropped": 0
            }
          }
        }
      },
      "nReturned": 288027,
      "executionTimeMillisEstimate": 156472
    },
    {
      "$_internalUnpackBucket": {
        "exclude": [],
        "timeField": "timestamp",
        "metaField": "metadata",
        "bucketMaxSpanSeconds": 2592000,
        "assumeNoMixedSchemaData": true,
        "eventFilter": {
          "location": {
            "$geoWithin": {
              "$geometry": {
                "type": "Polygon",
                "coordinates": [
                  [
                    [121.4737, 31.23437845899353],
                    [
                      121.47548050452737,
                      31.234075616835057
                    ],
                    [
                      121.47698994338076,
                      31.233213195332997
                    ],
                    [
                      121.47799851817783,
                      31.231922490343166
                    ],
                    [121.4783526825485, 31.2304],
                    [
                      121.47799851817783,
                      31.228877509656833
                    ],
                    [
                      121.47698994338076,
                      31.227586804667002
                    ],
                    [
                      121.47548050452737,
                      31.226724383164942
                    ],
                    [121.4737, 31.22642154100647],
                    [
                      121.47191949547262,
                      31.226724383164942
                    ],
                    [
                      121.47041005661923,
                      31.227586804667002
                    ],
                    [
                      121.46940148182216,
                      31.228877509656833
                    ],
                    [121.46904731745148, 31.2304],
                    [
                      121.46940148182216,
                      31.231922490343166
                    ],
                    [
                      121.47041005661923,
                      31.233213195332997
                    ],
                    [
                      121.47191949547262,
                      31.234075616835057
                    ],
                    [121.4737, 31.23437845899353],
                    [121.4737, 31.23437845899353]
                  ]
                ]
              }
            }
          }
        },
        "sbeCompatible": false
      },
      "nReturned": 8,
      "executionTimeMillisEstimate": 227682
    }
  ],
  "queryShapeHash": "B2E33124ABFE83BC03A13065C24A1A7F19AAEA8AB86597EBECCE33A43EF224CE",
  "serverInfo": {
    "host": "atlas-mdfv7l-shard-00-01.iv8lf.mongodb.net",
    "port": 27017,
    "version": "8.2.2",
    "gitVersion": "594f839ceec1f4385be9a690131412d67b249a0a"
  },
  "serverParameters": {
    "internalQueryFacetBufferSizeBytes": 104857600,
    "internalQueryFacetMaxOutputDocSizeBytes": 104857600,
    "internalLookupStageIntermediateDocumentMaxSizeBytes": 104857600,
    "internalDocumentSourceGroupMaxMemoryBytes": 104857600,
    "internalQueryMaxBlockingSortMemoryUsageBytes": 104857600,
    "internalQueryProhibitBlockingMergeOnMongoS": 0,
    "internalQueryMaxAddToSetBytes": 104857600,
    "internalDocumentSourceSetWindowFieldsMaxMemoryBytes": 104857600,
    "internalQueryFrameworkControl": "trySbeRestricted",
    "internalQueryPlannerIgnoreIndexWithCollationForRegex": 1
  },
  "command": {
    "aggregate": "system.buckets.containers",
    "pipeline": [
      {
        "$_internalUnpackBucket": {
          "timeField": "timestamp",
          "metaField": "metadata",
          "bucketMaxSpanSeconds": 2592000,
          "assumeNoMixedSchemaData": true,
          "usesExtendedRange": false,
          "fixedBuckets": false
        }
      },
      {
        "$match": {
          "location": {
            "$geoWithin": {
              "$geometry": {
                "type": "Polygon",
                "coordinates": [
                  [
                    [121.4737, 31.23437845899353],
                    [
                      121.47548050452737,
                      31.234075616835057
                    ],
                    [
                      121.47698994338076,
                      31.233213195332997
                    ],
                    [
                      121.47799851817783,
                      31.231922490343166
                    ],
                    [121.4783526825485, 31.2304],
                    [
                      121.47799851817783,
                      31.228877509656833
                    ],
                    [
                      121.47698994338076,
                      31.227586804667002
                    ],
                    [
                      121.47548050452737,
                      31.226724383164942
                    ],
                    [121.4737, 31.22642154100647],
                    [
                      121.47191949547262,
                      31.226724383164942
                    ],
                    [
                      121.47041005661923,
                      31.227586804667002
                    ],
                    [
                      121.46940148182216,
                      31.228877509656833
                    ],
                    [121.46904731745148, 31.2304],
                    [
                      121.46940148182216,
                      31.231922490343166
                    ],
                    [
                      121.47041005661923,
                      31.233213195332997
                    ],
                    [
                      121.47191949547262,
                      31.234075616835057
                    ],
                    [121.4737, 31.23437845899353],
                    [121.4737, 31.23437845899353]
                  ]
                ]
              }
            }
          }
        }
      }
    ],
    "cursor": {},
    "collation": { "locale": "simple" },
    "maxTimeMS": 60000
  },
  "ok": 1,
  "$clusterTime": {
    "clusterTime": {
      "$timestamp": "7578917243484897281"
    },
    "signature": {
      "hash": "YLudgRh8mdIhOPq2WODScdK/YDo=",
      "keyId": {
        "low": 2,
        "high": 1754462246,
        "unsigned": false
      }
    }
  },
  "operationTime": {
    "$timestamp": "7578917243484897281"
  }
}